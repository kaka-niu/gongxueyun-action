2026-01-08 10:45:36,964 - INFO - 检查登录状态
2026-01-08 10:45:36,966 - INFO - 检测到用户信息不一致，执行重新登录
2026-01-08 10:45:36,968 - INFO - 执行登录
2026-01-08 10:45:38,911 - INFO - 滑块匹配成功，最大相似度: 0.532844066619873
2026-01-08 10:45:38,912 - INFO - 提取PNG宽度成功: 47
2026-01-08 10:45:38,912 - INFO - 计算滑块距离成功: 147.0
2026-01-08 10:45:38,912 - INFO - 验证码识别成功: {'x': 147.0, 'y': 5}
2026-01-08 10:45:39,923 - INFO - 登录数据：{'phone': 'c2d932f42e0c4dea883a77b909c92e29', 'password': 'd9e73af3d1ef14f9fcd0a2f1fe609993', 'captcha': 'JI9UY2wBHznSLSoCuGDSYJD9DMpCTj7xelRbvIItBYxsryEH9svK8+GorNWg5yjMPUNTVJKQfSRDUroEc8H/Xw==', 'loginType': 'android', 'uuid': '8ae1694dc2734849975eea5905069b9d', 'device': 'android', 'version': '5.16.0', 't': '99080dc529d456b2679d38c657ffa13b'}
2026-01-08 10:45:40,714 - INFO - 登录结果：{'authType': 2, 'expiredTime': 2083459539000, 'gender': 1, 'headImg': 'f005585371b08470a447374c1a8e85c7.png', 'isAccount': 0, 'moguNo': '10417671', 'msgConfig': {}, 'neteaseImId': '9062490fa915410d8b1f6a6e5b53523c', 'nikeName': '刘香', 'orgJson': {'classId': '0ee0171f13a3208cc2db586efe299271', 'className': '智能231', 'depId': 'ef9deebb84b530d2f1c9de3db5af5cdb', 'depName': '电子信息学院', 'grade': '2023', 'majorField': '', 'majorId': 'e96d2943ce7d4fd9baf262843450ce41', 'majorName': '智能产品开发与应用', 'schoolId': 'f217a719d8f5c8b1dd1d628b17da70d0', 'schoolName': '绵阳职业技术学院', 'snowFlakeId': '1000373', 'studentId': '3a2088aaf0e03bf38351cc32948e34d1', 'studentNumber': '202301249', 'userName': '刘香'}, 'phone': '15808462201', 'roleGroup': [{'currPage': 1, 'orderBy': 'create_time', 'pageSize': 10, 'roleId': '1123121137695158273', 'roleKey': 'student', 'roleLevel': '0', 'roleName': '学生', 'sort': 'desc', 'totalCount': 0, 'totalPage': 0}], 'roleId': '1123121137695158273', 'roleKey': 'student', 'roleLevel': '0', 'roleName': '学生', 'token': 'eyJhbGciOiJIUzUxMiJ9.eyJpc3MiOiJtb2d1ZGluZy11c2VyIiwic3ViIjoie1wibG9naW5UeXBlXCI6XCJhbmRyb2lkXCIsXCJ1c2VySWRcIjoxMDgyMjY0NDF9IiwiYXVkIjoibW9ndWRpbmciLCJleHAiOjIwODM0NTk1MzksIm5iZiI6MTc2NzgzOTQzOSwiaWF0IjoxNzY3ODQwMzM5fQ._38fZU3qb5-D7WTgsJ11EE4azbShGtibWY84XlM4H2HmDOKAFbMswo9t0-G7G2uoIJCLPN5zsPeVlcJXWZmFng', 'userId': '108226441', 'userType': 'student'}
2026-01-08 10:45:40,716 - INFO - userInfo.json 已更新: D:\disk\GongXueYunAutoCheckIn_CodeVersion-master\GongXueYunAutoCheckIn_CodeVersion-master\user\userInfo.json
2026-01-08 10:45:40,716 - INFO - 用户信息已保存到 UserInfoManager 管理的文件和缓存中
2026-01-08 10:45:40,716 - INFO - 登录成功
2026-01-08 10:45:40,716 - INFO - 用户数据：{'authType': 2, 'expiredTime': 2083459539000, 'gender': 1, 'headImg': 'f005585371b08470a447374c1a8e85c7.png', 'isAccount': 0, 'moguNo': '10417671', 'msgConfig': {}, 'neteaseImId': '9062490fa915410d8b1f6a6e5b53523c', 'nikeName': '刘香', 'orgJson': {'classId': '0ee0171f13a3208cc2db586efe299271', 'className': '智能231', 'depId': 'ef9deebb84b530d2f1c9de3db5af5cdb', 'depName': '电子信息学院', 'grade': '2023', 'majorField': '', 'majorId': 'e96d2943ce7d4fd9baf262843450ce41', 'majorName': '智能产品开发与应用', 'schoolId': 'f217a719d8f5c8b1dd1d628b17da70d0', 'schoolName': '绵阳职业技术学院', 'snowFlakeId': '1000373', 'studentId': '3a2088aaf0e03bf38351cc32948e34d1', 'studentNumber': '202301249', 'userName': '刘香'}, 'phone': '15808462201', 'roleGroup': [{'currPage': 1, 'orderBy': 'create_time', 'pageSize': 10, 'roleId': '1123121137695158273', 'roleKey': 'student', 'roleLevel': '0', 'roleName': '学生', 'sort': 'desc', 'totalCount': 0, 'totalPage': 0}], 'roleId': '1123121137695158273', 'roleKey': 'student', 'roleLevel': '0', 'roleName': '学生', 'token': 'eyJhbGciOiJIUzUxMiJ9.eyJpc3MiOiJtb2d1ZGluZy11c2VyIiwic3ViIjoie1wibG9naW5UeXBlXCI6XCJhbmRyb2lkXCIsXCJ1c2VySWRcIjoxMDgyMjY0NDF9IiwiYXVkIjoibW9ndWRpbmciLCJleHAiOjIwODM0NTk1MzksIm5iZiI6MTc2NzgzOTQzOSwiaWF0IjoxNzY3ODQwMzM5fQ._38fZU3qb5-D7WTgsJ11EE4azbShGtibWY84XlM4H2HmDOKAFbMswo9t0-G7G2uoIJCLPN5zsPeVlcJXWZmFng', 'userId': '108226441', 'userType': 'student'}
2026-01-08 10:45:40,716 - INFO - 用户类型：student
2026-01-08 10:45:40,716 - INFO - 检查打卡信息
2026-01-08 10:45:40,717 - INFO - 未检测到打卡信息，开始执行获取打卡信息
2026-01-08 10:45:41,515 - INFO - 获取到的实习计划数据: {'totalCount': 0, 'pageSize': 10, 'totalPage': 0, 'currPage': 1, 'isDeleted': None, 'createBy': None, 'modifiedBy': None, 'createTime': None, 'modifiedTime': None, 'createByName': None, 'modifiedByName': None, 'orderBy': 'create_time', 'sort': 'desc', 'planId': 'ec6b6bfd032dd9a7ff04909a7459edd9', 'schoolId': None, 'depId': None, 'depName': None, 'planName': '2023级智能产品开发与应用2025-2026实习学年第一学期岗位实习', 'planNumber': None, 'planLevel': None, 'planGrades': None, 'type': 'GW_PRACTICE', 'startTime': '2025-12-08 00:00:00', 'endTime': '2026-01-09 00:00:00', 'subsidy': None, 'description': None, 'planState': None, 'backup': None, 'isSign': 1, 'isAuto': '0', 'batchId': 'ebbd0c1d43afa3285007a85f9738c77b', 'practiceStus': None, 'snowFlakeId': None, 'batchName': '2025-2026', 'planPaper': {'isDeleted': 0, 'createTime': '2025-11-25 18:47:52', 'planPaperId': '0b479e8f0b888519368258f244bad5b3', 'planId': 'ec6b6bfd032dd9a7ff04909a7459edd9', 'dayPaperNum': 0, 'weekPaperNum': 200, 'monthPaperNum': 0, 'summaryPaperNum': 3000, 'weekReportCount': 5, 'paperReportCount': 25, 'monthReportCount': 1, 'summaryReportCount': 1, 'maxDayNum': 8000, 'maxWeekNum': 8000, 'maxMonthNum': 8000, 'maxSummaryNum': 8000, 'snowFlakeId': 1000373, 'dayPaper': True, 'weekPaper': True, 'monthPaper': True, 'summaryPaper': True}, 'planPaperMap': None, 'attachments': None, 'planMajors': None, 'planClasses': None, 'planAppraiseItem': None, 'planAppraiseItemDtos': None, 'planAppraiseItemEntities': None, 'majorNames': None, 'createName': '史瑞环', 'attachmentNum': 1, 'planIds': None, 'signCount': None, 'auditState': None, 'majorTeacher': None, 'majorId': None, 'majorName': None, 'majorField': None, 'semester': None, 'planExtra': None, 'majorTeacherId': None, 'isSysDefault': 0, 'internshipForm': None, 'teacherName': '157b5e107cf7bfc863e7d8acf02e1c55', 'teacherId': None, 'mobile': 'af2ce7966ebb217b86a3f09604fc3c5f', 'isCopyAllocate': None, 'isCopy': None, 'isShowUpDel': None, 'isBuyInsurance': None, 'stuItemIds': None, 'selfMultiple': None, 'schoolTeacher': None, 'companyMultiple': None, 'multipleTheory': None, 'practiceState': 3, 'aboutType': None, 'practiceTeas': None, 'practiceStateNum': None, 'programId': None, 'attachmentsList': None, 'isTalentPlan': None, 'comment': None, 'auditName': None, 'isApply': 0, 'levelEntity': None, 'insuranceList': None}
2026-01-08 10:45:41,517 - INFO - planInfo.json 已更新: D:\disk\GongXueYunAutoCheckIn_CodeVersion-master\GongXueYunAutoCheckIn_CodeVersion-master\user\planInfo.json
2026-01-08 10:45:41,517 - INFO - 实习计划信息已更新到 PlanInfoManager
2026-01-08 10:45:41,517 - INFO - 打卡信息获取成功
2026-01-08 10:45:41,517 - INFO - 执行签到打卡
2026-01-08 10:45:42,284 - INFO - 用户 刘* 开始 上班 打卡
2026-01-08 10:45:42,284 - INFO - 打卡类型：START
2026-01-08 10:45:43,174 - INFO - 打卡成功
2026-01-08 10:45:43,175 - INFO - {'title': '工学云签到成功通知', 'content': '签到账号：15808462201\n签到地点：四川省 · 资阳市 · 乐至县 · 友谊路南段与川西环线交叉口东北300米'}
2026-01-08 21:06:44,238 - INFO - 检查登录状态
2026-01-08 21:06:44,239 - INFO - 检测到本地 token，跳过登录
2026-01-08 21:06:44,240 - INFO - 用户数据：{'authType': 2, 'expiredTime': 2083459539000, 'gender': 1, 'headImg': 'f005585371b08470a447374c1a8e85c7.png', 'isAccount': 0, 'moguNo': '10417671', 'msgConfig': {}, 'neteaseImId': '9062490fa915410d8b1f6a6e5b53523c', 'nikeName': '刘香', 'orgJson': {'classId': '0ee0171f13a3208cc2db586efe299271', 'className': '智能231', 'depId': 'ef9deebb84b530d2f1c9de3db5af5cdb', 'depName': '电子信息学院', 'grade': '2023', 'majorField': '', 'majorId': 'e96d2943ce7d4fd9baf262843450ce41', 'majorName': '智能产品开发与应用', 'schoolId': 'f217a719d8f5c8b1dd1d628b17da70d0', 'schoolName': '绵阳职业技术学院', 'snowFlakeId': '1000373', 'studentId': '3a2088aaf0e03bf38351cc32948e34d1', 'studentNumber': '202301249', 'userName': '刘香'}, 'phone': '15808462201', 'roleGroup': [{'currPage': 1, 'orderBy': 'create_time', 'pageSize': 10, 'roleId': '1123121137695158273', 'roleKey': 'student', 'roleLevel': '0', 'roleName': '学生', 'sort': 'desc', 'totalCount': 0, 'totalPage': 0}], 'roleId': '1123121137695158273', 'roleKey': 'student', 'roleLevel': '0', 'roleName': '学生', 'token': 'eyJhbGciOiJIUzUxMiJ9.eyJpc3MiOiJtb2d1ZGluZy11c2VyIiwic3ViIjoie1wibG9naW5UeXBlXCI6XCJhbmRyb2lkXCIsXCJ1c2VySWRcIjoxMDgyMjY0NDF9IiwiYXVkIjoibW9ndWRpbmciLCJleHAiOjIwODM0NTk1MzksIm5iZiI6MTc2NzgzOTQzOSwiaWF0IjoxNzY3ODQwMzM5fQ._38fZU3qb5-D7WTgsJ11EE4azbShGtibWY84XlM4H2HmDOKAFbMswo9t0-G7G2uoIJCLPN5zsPeVlcJXWZmFng', 'userId': '108226441', 'userType': 'student'}
2026-01-08 21:06:44,240 - INFO - 用户类型：student
2026-01-08 21:06:44,240 - INFO - 检查打卡信息
2026-01-08 21:06:44,241 - INFO - 检测到本地已有打卡信息 ，跳过获取打卡信息
2026-01-08 21:06:44,241 - INFO - 执行签到打卡
2026-01-08 21:06:46,083 - WARNING - Token失效，正在重新登录...
2026-01-08 21:06:46,084 - INFO - 执行登录
2026-01-08 21:06:47,023 - INFO - 滑块匹配成功，最大相似度: 0.3512515425682068
2026-01-08 21:06:47,023 - INFO - 提取PNG宽度成功: 47
2026-01-08 21:06:47,023 - INFO - 计算滑块距离成功: 130.1
2026-01-08 21:06:47,024 - INFO - 验证码识别成功: {'x': 130.1, 'y': 5}
2026-01-08 21:06:47,794 - INFO - 登录数据：{'phone': 'c2d932f42e0c4dea883a77b909c92e29', 'password': 'd9e73af3d1ef14f9fcd0a2f1fe609993', 'captcha': 'HybMGJdxbqg1ON/yLZZOCZHACvUMEBogatxbCPnhwl1OEtDsDmaUEQs8m0ETnOs0cXxfOuM+L0GebI8Kb5PnDQ==', 'loginType': 'android', 'uuid': '71d0070f92464cf1ab8513718ec724dc', 'device': 'android', 'version': '5.16.0', 't': '5c2da1decc355734408e67ab85921b56'}
2026-01-08 21:06:48,536 - INFO - 登录结果：{'authType': 2, 'expiredTime': 2083496807000, 'gender': 1, 'headImg': 'f005585371b08470a447374c1a8e85c7.png', 'isAccount': 0, 'moguNo': '10417671', 'msgConfig': {}, 'neteaseImId': '9062490fa915410d8b1f6a6e5b53523c', 'nikeName': '刘香', 'orgJson': {'classId': '0ee0171f13a3208cc2db586efe299271', 'className': '智能231', 'depId': 'ef9deebb84b530d2f1c9de3db5af5cdb', 'depName': '电子信息学院', 'grade': '2023', 'majorField': '', 'majorId': 'e96d2943ce7d4fd9baf262843450ce41', 'majorName': '智能产品开发与应用', 'schoolId': 'f217a719d8f5c8b1dd1d628b17da70d0', 'schoolName': '绵阳职业技术学院', 'snowFlakeId': '1000373', 'studentId': '3a2088aaf0e03bf38351cc32948e34d1', 'studentNumber': '202301249', 'userName': '刘香'}, 'phone': '15808462201', 'roleGroup': [{'currPage': 1, 'orderBy': 'create_time', 'pageSize': 10, 'roleId': '1123121137695158273', 'roleKey': 'student', 'roleLevel': '0', 'roleName': '学生', 'sort': 'desc', 'totalCount': 0, 'totalPage': 0}], 'roleId': '1123121137695158273', 'roleKey': 'student', 'roleLevel': '0', 'roleName': '学生', 'token': 'eyJhbGciOiJIUzUxMiJ9.eyJpc3MiOiJtb2d1ZGluZy11c2VyIiwic3ViIjoie1wibG9naW5UeXBlXCI6XCJhbmRyb2lkXCIsXCJ1c2VySWRcIjoxMDgyMjY0NDF9IiwiYXVkIjoibW9ndWRpbmciLCJleHAiOjIwODM0OTY4MDcsIm5iZiI6MTc2Nzg3NjcwNywiaWF0IjoxNzY3ODc3NjA3fQ.QQnMYjnH3bVrLf8xmapEmiEPCpF9egNS_jc3R3ECvOGt5AaLelJJI0BZFzZNfuE7k7IVcQXNTQlsVcZ4Nh3esA', 'userId': '108226441', 'userType': 'student'}
2026-01-08 21:06:48,538 - INFO - userInfo.json 已更新: D:\disk\GongXueYunAutoCheckIn_CodeVersion-master\GongXueYunAutoCheckIn_CodeVersion-master\user\userInfo.json
2026-01-08 21:06:48,538 - INFO - 用户信息已保存到 UserInfoManager 管理的文件和缓存中
2026-01-08 21:06:48,538 - INFO - 已更新 Authorization Token，重试请求
2026-01-08 21:06:49,295 - INFO - 今日[上班]卡已打，无需重复打卡
2026-01-08 21:06:49,295 - INFO - {'title': '工学云签到任务通知', 'content': '今日[上班]卡已打，无需重复打卡'}
2026-01-08 21:17:26,637 - INFO - 当前时间 21:17，执行下班卡测试
2026-01-08 21:17:26,638 - INFO - 检查登录状态
2026-01-08 21:17:26,638 - INFO - 检测到本地 token，跳过登录
2026-01-08 21:17:26,638 - INFO - 用户数据：{'authType': 2, 'expiredTime': 2083496807000, 'gender': 1, 'headImg': 'f005585371b08470a447374c1a8e85c7.png', 'isAccount': 0, 'moguNo': '10417671', 'msgConfig': {}, 'neteaseImId': '9062490fa915410d8b1f6a6e5b53523c', 'nikeName': '刘香', 'orgJson': {'classId': '0ee0171f13a3208cc2db586efe299271', 'className': '智能231', 'depId': 'ef9deebb84b530d2f1c9de3db5af5cdb', 'depName': '电子信息学院', 'grade': '2023', 'majorField': '', 'majorId': 'e96d2943ce7d4fd9baf262843450ce41', 'majorName': '智能产品开发与应用', 'schoolId': 'f217a719d8f5c8b1dd1d628b17da70d0', 'schoolName': '绵阳职业技术学院', 'snowFlakeId': '1000373', 'studentId': '3a2088aaf0e03bf38351cc32948e34d1', 'studentNumber': '202301249', 'userName': '刘香'}, 'phone': '15808462201', 'roleGroup': [{'currPage': 1, 'orderBy': 'create_time', 'pageSize': 10, 'roleId': '1123121137695158273', 'roleKey': 'student', 'roleLevel': '0', 'roleName': '学生', 'sort': 'desc', 'totalCount': 0, 'totalPage': 0}], 'roleId': '1123121137695158273', 'roleKey': 'student', 'roleLevel': '0', 'roleName': '学生', 'token': 'eyJhbGciOiJIUzUxMiJ9.eyJpc3MiOiJtb2d1ZGluZy11c2VyIiwic3ViIjoie1wibG9naW5UeXBlXCI6XCJhbmRyb2lkXCIsXCJ1c2VySWRcIjoxMDgyMjY0NDF9IiwiYXVkIjoibW9ndWRpbmciLCJleHAiOjIwODM0OTY4MDcsIm5iZiI6MTc2Nzg3NjcwNywiaWF0IjoxNzY3ODc3NjA3fQ.QQnMYjnH3bVrLf8xmapEmiEPCpF9egNS_jc3R3ECvOGt5AaLelJJI0BZFzZNfuE7k7IVcQXNTQlsVcZ4Nh3esA', 'userId': '108226441', 'userType': 'student'}
2026-01-08 21:17:26,639 - INFO - 用户类型：student
2026-01-08 21:17:26,639 - INFO - 检查打卡信息
2026-01-08 21:17:26,639 - INFO - 检测到本地已有打卡信息 ，跳过获取打卡信息
2026-01-08 21:17:26,639 - INFO - 执行签到打卡
2026-01-08 21:17:27,454 - INFO - 今日[上班]卡已打，无需重复打卡
2026-01-08 21:17:27,454 - INFO - 下班卡测试结果：{'title': '工学云签到任务通知', 'content': '今日[上班]卡已打，无需重复打卡'}
2026-01-08 21:17:41,971 - INFO - 当前时间 21:17，执行下班卡测试
2026-01-08 21:17:41,971 - INFO - 检查登录状态
2026-01-08 21:17:41,972 - INFO - 检测到本地 token，跳过登录
2026-01-08 21:17:41,972 - INFO - 用户数据：{'authType': 2, 'expiredTime': 2083496807000, 'gender': 1, 'headImg': 'f005585371b08470a447374c1a8e85c7.png', 'isAccount': 0, 'moguNo': '10417671', 'msgConfig': {}, 'neteaseImId': '9062490fa915410d8b1f6a6e5b53523c', 'nikeName': '刘香', 'orgJson': {'classId': '0ee0171f13a3208cc2db586efe299271', 'className': '智能231', 'depId': 'ef9deebb84b530d2f1c9de3db5af5cdb', 'depName': '电子信息学院', 'grade': '2023', 'majorField': '', 'majorId': 'e96d2943ce7d4fd9baf262843450ce41', 'majorName': '智能产品开发与应用', 'schoolId': 'f217a719d8f5c8b1dd1d628b17da70d0', 'schoolName': '绵阳职业技术学院', 'snowFlakeId': '1000373', 'studentId': '3a2088aaf0e03bf38351cc32948e34d1', 'studentNumber': '202301249', 'userName': '刘香'}, 'phone': '15808462201', 'roleGroup': [{'currPage': 1, 'orderBy': 'create_time', 'pageSize': 10, 'roleId': '1123121137695158273', 'roleKey': 'student', 'roleLevel': '0', 'roleName': '学生', 'sort': 'desc', 'totalCount': 0, 'totalPage': 0}], 'roleId': '1123121137695158273', 'roleKey': 'student', 'roleLevel': '0', 'roleName': '学生', 'token': 'eyJhbGciOiJIUzUxMiJ9.eyJpc3MiOiJtb2d1ZGluZy11c2VyIiwic3ViIjoie1wibG9naW5UeXBlXCI6XCJhbmRyb2lkXCIsXCJ1c2VySWRcIjoxMDgyMjY0NDF9IiwiYXVkIjoibW9ndWRpbmciLCJleHAiOjIwODM0OTY4MDcsIm5iZiI6MTc2Nzg3NjcwNywiaWF0IjoxNzY3ODc3NjA3fQ.QQnMYjnH3bVrLf8xmapEmiEPCpF9egNS_jc3R3ECvOGt5AaLelJJI0BZFzZNfuE7k7IVcQXNTQlsVcZ4Nh3esA', 'userId': '108226441', 'userType': 'student'}
2026-01-08 21:17:41,972 - INFO - 用户类型：student
2026-01-08 21:17:41,972 - INFO - 检查打卡信息
2026-01-08 21:17:41,973 - INFO - 检测到本地已有打卡信息 ，跳过获取打卡信息
2026-01-08 21:17:41,973 - INFO - 执行签到打卡
2026-01-08 21:17:42,737 - INFO - 今日[上班]卡已打，无需重复打卡
2026-01-08 21:17:42,737 - INFO - 下班卡测试结果：{'title': '工学云签到任务通知', 'content': '今日[上班]卡已打，无需重复打卡'}
2026-01-08 21:20:03,597 - INFO - 当前时间 21:20，执行下班卡测试
2026-01-08 21:20:03,598 - INFO - 检查登录状态
2026-01-08 21:20:03,598 - ERROR - 读取 config.json 失败: 'list' object has no attribute 'get'
2026-01-08 21:20:03,598 - INFO - 检测到用户信息不一致，执行重新登录
2026-01-08 21:20:03,598 - INFO - 执行登录
2026-01-08 21:20:03,599 - ERROR - 读取 config.json 失败: 'list' object has no attribute 'get'
2026-01-08 21:20:03,607 - ERROR - 加密失败: 'NoneType' object has no attribute 'encode'
2026-01-08 21:20:03,607 - ERROR - 登录过程发生异常：加密失败: 'NoneType' object has no attribute 'encode'
Traceback (most recent call last):
  File "d:\disk\GongXueYunAutoCheckIn_CodeVersion-master\GongXueYunAutoCheckIn_CodeVersion-master\util\CryptoUtils.py", line 59, in aes_encrypt
    ciphertext = cipher.encrypt(plaintext)
  File "E:\appication\python\Lib\site-packages\aes_pkcs5\algorithms\__init__.py", line 32, in encrypt
    message = message.encode()
              ^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'encode'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\disk\GongXueYunAutoCheckIn_CodeVersion-master\GongXueYunAutoCheckIn_CodeVersion-master\util\ApiService.py", line 253, in login
    "phone": aes_encrypt(ConfigManager.get("user", "phone")),
             ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\disk\GongXueYunAutoCheckIn_CodeVersion-master\GongXueYunAutoCheckIn_CodeVersion-master\util\CryptoUtils.py", line 64, in aes_encrypt
    raise ValueError(f"加密失败: {str(e)}")
ValueError: 加密失败: 'NoneType' object has no attribute 'encode'
2026-01-08 21:20:03,611 - WARNING - 登录失败
2026-01-08 21:20:03,611 - WARNING - 登录失败
2026-01-08 21:21:39,805 - INFO - 当前时间 21:21，执行下班卡测试
2026-01-08 21:21:39,805 - INFO - 检查登录状态
2026-01-08 21:21:39,806 - INFO - 检测到本地 token，跳过登录
2026-01-08 21:21:39,806 - INFO - 用户数据：{'authType': 2, 'expiredTime': 2083496807000, 'gender': 1, 'headImg': 'f005585371b08470a447374c1a8e85c7.png', 'isAccount': 0, 'moguNo': '10417671', 'msgConfig': {}, 'neteaseImId': '9062490fa915410d8b1f6a6e5b53523c', 'nikeName': '刘香', 'orgJson': {'classId': '0ee0171f13a3208cc2db586efe299271', 'className': '智能231', 'depId': 'ef9deebb84b530d2f1c9de3db5af5cdb', 'depName': '电子信息学院', 'grade': '2023', 'majorField': '', 'majorId': 'e96d2943ce7d4fd9baf262843450ce41', 'majorName': '智能产品开发与应用', 'schoolId': 'f217a719d8f5c8b1dd1d628b17da70d0', 'schoolName': '绵阳职业技术学院', 'snowFlakeId': '1000373', 'studentId': '3a2088aaf0e03bf38351cc32948e34d1', 'studentNumber': '202301249', 'userName': '刘香'}, 'phone': '15808462201', 'roleGroup': [{'currPage': 1, 'orderBy': 'create_time', 'pageSize': 10, 'roleId': '1123121137695158273', 'roleKey': 'student', 'roleLevel': '0', 'roleName': '学生', 'sort': 'desc', 'totalCount': 0, 'totalPage': 0}], 'roleId': '1123121137695158273', 'roleKey': 'student', 'roleLevel': '0', 'roleName': '学生', 'token': 'eyJhbGciOiJIUzUxMiJ9.eyJpc3MiOiJtb2d1ZGluZy11c2VyIiwic3ViIjoie1wibG9naW5UeXBlXCI6XCJhbmRyb2lkXCIsXCJ1c2VySWRcIjoxMDgyMjY0NDF9IiwiYXVkIjoibW9ndWRpbmciLCJleHAiOjIwODM0OTY4MDcsIm5iZiI6MTc2Nzg3NjcwNywiaWF0IjoxNzY3ODc3NjA3fQ.QQnMYjnH3bVrLf8xmapEmiEPCpF9egNS_jc3R3ECvOGt5AaLelJJI0BZFzZNfuE7k7IVcQXNTQlsVcZ4Nh3esA', 'userId': '108226441', 'userType': 'student'}
2026-01-08 21:21:39,806 - INFO - 用户类型：student
2026-01-08 21:21:39,806 - INFO - 检查打卡信息
2026-01-08 21:21:39,807 - INFO - 检测到本地已有打卡信息 ，跳过获取打卡信息
2026-01-08 21:21:39,807 - INFO - 执行签到打卡
2026-01-08 21:21:40,617 - INFO - 用户 刘* 开始 下班 打卡
2026-01-08 21:21:40,617 - INFO - 打卡类型：END
2026-01-08 21:21:41,390 - INFO - 打卡成功
2026-01-08 21:21:41,390 - INFO - 下班卡测试结果：{'title': '工学云签到成功通知', 'content': '签到账号：15808462201\n签到地点：四川省 · 资阳市 · 乐至县 · 友谊路南段与川西环线交叉口东北300米'}
2026-01-08 21:22:37,165 - INFO - 当前时间 21:22，执行下班卡测试
2026-01-08 21:22:37,165 - INFO - 检查登录状态
2026-01-08 21:22:37,166 - INFO - 检测到本地 token，跳过登录
2026-01-08 21:22:37,166 - INFO - 用户数据：{'authType': 2, 'expiredTime': 2083496807000, 'gender': 1, 'headImg': 'f005585371b08470a447374c1a8e85c7.png', 'isAccount': 0, 'moguNo': '10417671', 'msgConfig': {}, 'neteaseImId': '9062490fa915410d8b1f6a6e5b53523c', 'nikeName': '刘香', 'orgJson': {'classId': '0ee0171f13a3208cc2db586efe299271', 'className': '智能231', 'depId': 'ef9deebb84b530d2f1c9de3db5af5cdb', 'depName': '电子信息学院', 'grade': '2023', 'majorField': '', 'majorId': 'e96d2943ce7d4fd9baf262843450ce41', 'majorName': '智能产品开发与应用', 'schoolId': 'f217a719d8f5c8b1dd1d628b17da70d0', 'schoolName': '绵阳职业技术学院', 'snowFlakeId': '1000373', 'studentId': '3a2088aaf0e03bf38351cc32948e34d1', 'studentNumber': '202301249', 'userName': '刘香'}, 'phone': '15808462201', 'roleGroup': [{'currPage': 1, 'orderBy': 'create_time', 'pageSize': 10, 'roleId': '1123121137695158273', 'roleKey': 'student', 'roleLevel': '0', 'roleName': '学生', 'sort': 'desc', 'totalCount': 0, 'totalPage': 0}], 'roleId': '1123121137695158273', 'roleKey': 'student', 'roleLevel': '0', 'roleName': '学生', 'token': 'eyJhbGciOiJIUzUxMiJ9.eyJpc3MiOiJtb2d1ZGluZy11c2VyIiwic3ViIjoie1wibG9naW5UeXBlXCI6XCJhbmRyb2lkXCIsXCJ1c2VySWRcIjoxMDgyMjY0NDF9IiwiYXVkIjoibW9ndWRpbmciLCJleHAiOjIwODM0OTY4MDcsIm5iZiI6MTc2Nzg3NjcwNywiaWF0IjoxNzY3ODc3NjA3fQ.QQnMYjnH3bVrLf8xmapEmiEPCpF9egNS_jc3R3ECvOGt5AaLelJJI0BZFzZNfuE7k7IVcQXNTQlsVcZ4Nh3esA', 'userId': '108226441', 'userType': 'student'}
2026-01-08 21:22:37,166 - INFO - 用户类型：student
2026-01-08 21:22:37,166 - INFO - 检查打卡信息
2026-01-08 21:22:37,167 - INFO - 检测到本地已有打卡信息 ，跳过获取打卡信息
2026-01-08 21:22:37,167 - INFO - 执行签到打卡
2026-01-08 21:22:39,088 - WARNING - Token失效，正在重新登录...
2026-01-08 21:22:39,088 - INFO - 执行登录
2026-01-08 21:22:40,015 - INFO - 滑块匹配成功，最大相似度: 0.18226853013038635
2026-01-08 21:22:40,015 - INFO - 提取PNG宽度成功: 47
2026-01-08 21:22:40,015 - INFO - 计算滑块距离成功: 246.0
2026-01-08 21:22:40,016 - INFO - 验证码识别成功: {'x': 246.0, 'y': 5}
2026-01-08 21:22:40,771 - INFO - 登录数据：{'phone': 'c2d932f42e0c4dea883a77b909c92e29', 'password': 'd9e73af3d1ef14f9fcd0a2f1fe609993', 'captcha': 'ebpKq5nR8ikRMRqmDYQZnq3+iYSNS0/3fwQ7LQFr1w/lS5xRsgBEuDh58Qcc7GG/CFCLUXAZk9luaMOeB31BJQ==', 'loginType': 'android', 'uuid': '2a2bd3c3ee9045dda20cf3f55ec44ec1', 'device': 'android', 'version': '5.16.0', 't': 'e72150f4a950b5c95fe8b808f2c2f040'}
2026-01-08 21:22:41,538 - INFO - 登录结果：{'authType': 2, 'expiredTime': 2083497760000, 'gender': 1, 'headImg': 'f005585371b08470a447374c1a8e85c7.png', 'isAccount': 0, 'moguNo': '10417671', 'msgConfig': {}, 'neteaseImId': '9062490fa915410d8b1f6a6e5b53523c', 'nikeName': '刘香', 'orgJson': {'classId': '0ee0171f13a3208cc2db586efe299271', 'className': '智能231', 'depId': 'ef9deebb84b530d2f1c9de3db5af5cdb', 'depName': '电子信息学院', 'grade': '2023', 'majorField': '', 'majorId': 'e96d2943ce7d4fd9baf262843450ce41', 'majorName': '智能产品开发与应用', 'schoolId': 'f217a719d8f5c8b1dd1d628b17da70d0', 'schoolName': '绵阳职业技术学院', 'snowFlakeId': '1000373', 'studentId': '3a2088aaf0e03bf38351cc32948e34d1', 'studentNumber': '202301249', 'userName': '刘香'}, 'phone': '15808462201', 'roleGroup': [{'currPage': 1, 'orderBy': 'create_time', 'pageSize': 10, 'roleId': '1123121137695158273', 'roleKey': 'student', 'roleLevel': '0', 'roleName': '学生', 'sort': 'desc', 'totalCount': 0, 'totalPage': 0}], 'roleId': '1123121137695158273', 'roleKey': 'student', 'roleLevel': '0', 'roleName': '学生', 'token': 'eyJhbGciOiJIUzUxMiJ9.eyJpc3MiOiJtb2d1ZGluZy11c2VyIiwic3ViIjoie1wibG9naW5UeXBlXCI6XCJhbmRyb2lkXCIsXCJ1c2VySWRcIjoxMDgyMjY0NDF9IiwiYXVkIjoibW9ndWRpbmciLCJleHAiOjIwODM0OTc3NjAsIm5iZiI6MTc2Nzg3NzY2MCwiaWF0IjoxNzY3ODc4NTYwfQ.4eEIOOLhst4DEQb0uHxgSu2FhGK2WDAWmzIFMqLxp-8lwkgIzQjkuANX3szL5MInHPmScwBNpdrr833GZsnPmQ', 'userId': '108226441', 'userType': 'student'}
2026-01-08 21:22:41,540 - INFO - userInfo.json 已更新: D:\disk\GongXueYunAutoCheckIn_CodeVersion-master\GongXueYunAutoCheckIn_CodeVersion-master\user\userInfo.json
2026-01-08 21:22:41,540 - INFO - 用户信息已保存到 UserInfoManager 管理的文件和缓存中
2026-01-08 21:22:41,540 - INFO - 已更新 Authorization Token，重试请求
2026-01-08 21:22:42,275 - INFO - 今日[下班]卡已打，无需重复打卡
2026-01-08 21:22:42,275 - INFO - 下班卡测试结果：{'title': '工学云签到任务通知', 'content': '今日[下班]卡已打，无需重复打卡'}
2026-01-08 21:22:43,190 - INFO - 邮件已成功发送到 2154335573@qq.com
2026-01-08 21:22:43,233 - ERROR - SMTP响应异常：(-1, b'\x00\x00\x00')
